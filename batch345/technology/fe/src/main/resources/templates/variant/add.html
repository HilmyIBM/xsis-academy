<span id="txtTitle" class="d-none" th:text="${title}"></span>
<div class="card">
  <div class="card-body">
    <form id="frmNewVariant">

      <div class="form-group">
        <label for="txtName" class="form-label"> Name </label>
        <input type="text" class="form-control" id="txtName" name="name" />
      </div>
      <div class="form-group">
        <label for="txtDescription" class="form-label"> Description </label>
        <input
          type="text"
          class="form-control"
          id="txtDescription"
          name="description"
        />
      </div>
      <div class="form-group">
        <label for="txtCategoryName" class="form-label">Category Name</label>
        <select class="form-control" id="txtCategoryName" name="categoryId" required>
          <option value="" disabled selected>Select a category</option>
          <th:block th:each="category : ${categories}">
            <option th:value="${category.id}" th:text="${category.categoryName}" 
                    th:selected="${variant.categoryId == category.id}"></option>
          </th:block>
        </select>
      </div>
      <div class="text-right">
        <button class="btn btn-success mt-3"><i class="fas fa-save" type="submit"></i>&nbsp; Save</button>
      </div>
    </form>
  </div>
</div>


<script>
  $(document).ready(function(){
      $("#staticModalLabel").text($("#txtTitle").text());

      $("#frmNewVariant").validate({
          "rules" : {
              "name": {
                  "required": true,
                  "maxlength": 100,
                  "minlength": 3
              },
              "description": {
                  "maxlength": 100
              }, 
              "categoryId": {
                "required": true
              }
          },
          "errorClass": "text-danger"
      });

      $("#frmNewVariant").submit(function(e) {
          e.preventDefault();

          if ($("#frmNewVariant").valid()) {
              $.ajax({
                  url: "/variant/create",
                  type: "post",
                  data: $("#frmNewVariant").serialize(),
                  dataType: "json",
                  beforeSend: () => {
                      // alert("mengirim data ke api");
                  },
                  success: function(response) {
                      alert("Variant " + response.name + " succesfully created!");
                      location.reload();
                  },
                  error: function(errResponse) {
                      console.error("Create new Variant Failed: " + errResponse.responseText);
                  }
              });
          }
      });
  });
</script>